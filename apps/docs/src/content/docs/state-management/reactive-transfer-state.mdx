---
title: Reactive transfer state
description: State integration isolated by request that is transferred from server to client
---
import { Code, Tabs, TabItem, Aside, Steps } from '@astrojs/starlight/components';

import { Example, ExamplePreview } from '@astro-tools/docs-utils/example';

import TransferStateExample from './_examples/reactive-transfer-state/Example.astro';

import uuidStoreExampleRaw from './_examples/reactive-transfer-state/uuid-store.ts?raw';
import transferStateExampleRaw from './_examples/reactive-transfer-state/Example.astro?raw';
import transferStateExampleChildRaw from './_examples/reactive-transfer-state/Example.svelte?raw';
import outputCodeExample from '@astro-tools/docs-utils/components/Output.svelte?raw';

The Reactive transfer state uses `nanostores` to bring up reactivity to the `@astro-tools/transfer-state` library.

This way, you can subscribe to store changes and follow the Astro recommendations for sharing state with the improvement of having
isolated state between requests and transferred state from server to client, with Astro and any UI framework.

## Setup

Include the library in your Astro application, using your preferred package manager:
```
npm i -D @astro-tools/reactive-transfer-state
```
<Aside type="note">For using this library, [`@astro-tools/transfer-state`](/state-management/transfer-state/) and `nanostores` must be installed.</Aside>

## Use

Use `withTransferState` with any `ReadableAtom` from `nanostores` library to create a store. This store will be transferred from the server to the client and will be isolated by request:

```typescript
import { atom } from 'nanostores';

export const myStore = withTransferState('key', atom('initial value'));
```

Then use the store in any Astro or UI framework component.

<Aside type="tip">Take a look to the `nanostores` [documentation page](https://github.com/nanostores/nanostores/tree/main) for more details about the different stores.</Aside>

For example, the `Example.svelte` is rendered in server-side using the `uuid` nanostore. The hydration process keeps the value as it comes from server:

<Example>
  <Tabs>
    <TabItem label="Example.astro">
      <Code code={transferStateExampleRaw} lang="astro" />
    </TabItem>
    <TabItem label="Example.svelte">
      <Code code={transferStateExampleChildRaw} lang="astro" />
    </TabItem>
    <TabItem label="uuid-store.ts">
      <Code code={uuidStoreExampleRaw} lang="typescript" />
    </TabItem>
    <TabItem label="Output.svelte">
      <Code code={outputCodeExample} lang="svelte" />
    </TabItem>
  </Tabs>
  <ExamplePreview hydration="example">
    <TransferStateExample id="example" />
  </ExamplePreview>
</Example>
